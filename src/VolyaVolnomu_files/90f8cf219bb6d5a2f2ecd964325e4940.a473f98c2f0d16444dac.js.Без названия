(self.webpackChunkvk=self.webpackChunkvk||[]).push([[85820],{428817:e=>{e.exports={reactions_preview_item:'<div class="ReactionsPreviewItem ReactionsPreviewItem--stackOverlay %class%" style="background-image: url(\'%image_url%\');" aria-label="%title%"></div>'}},961943:(e,t,n)=>{"use strict";n.d(t,{default:()=>r});const r=(0,n(28178).makeIcon)("Icon20GearOutline","gear_outline_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20" id="gear_outline_20"><path fill-rule="evenodd" d="m7.222 3.378.01-.033a4.147 4.147 0 0 1 .17-.476c.358-.821.944-1.285 1.854-1.36l.166-.009h1.208c1.051.033 1.735.608 2.095 1.692l.057.186.044.166c.016.064.037.132.06.203l.05.137.03.015.06-.02.116-.044.135-.059a5.36 5.36 0 0 1 .168-.074l.036-.015a4.23 4.23 0 0 1 .424-.15c.932-.27 1.685-.075 2.32.618l.108.125.714.88c.636.833.617 1.723-.004 2.683l-.109.161-.102.139c-.04.054-.082.113-.123.177l-.062.1-.029.05.004.017.08.052.11.066.133.072c1.209.614 1.707 1.42 1.515 2.541l-.032.162-.213.916c-.137.593-.245.873-.67 1.258a2.135 2.135 0 0 1-1.059.518l-.01.003a3.917 3.917 0 0 1-.438.059l-.191.012-.173.006-.052.001h-.006c-.05.002-.102.006-.156.01l-.158.02.012.123.011.083.029.154c.068.322.101.618.098.89v.012c-.015.84-.38 1.45-1.132 1.87l-.147.076-1.023.494c-.901.403-1.722.234-2.484-.467a3.934 3.934 0 0 1-.144-.14l-.133-.142-.113-.13a2.938 2.938 0 0 0-.147-.161l-.085-.083-.043-.04-.08.076-.091.093-.103.115c-.828.981-1.703 1.334-2.763.923l-.153-.063-.915-.443-.271-.138c-.415-.225-.647-.44-.874-.918a2.153 2.153 0 0 1-.209-1.01v-.016c.006-.19.03-.388.07-.603l.038-.195.001-.004c.014-.064.025-.133.035-.206l.016-.148-.003-.003-.09-.012-.128-.012-.151-.006a4.145 4.145 0 0 1-.862-.098l-.012-.003c-.837-.198-1.363-.69-1.608-1.524l-.043-.16-.254-1.102c-.204-1.026.205-1.818 1.186-2.41l.17-.098.152-.08c.06-.03.123-.065.188-.105l.134-.087.004-.017-.055-.093-.07-.108-.089-.124a5.194 5.194 0 0 1-.286-.423c-.54-.905-.534-1.72.046-2.523l.1-.132.717-.877c.687-.792 1.566-.958 2.64-.554l.18.072.158.07a2.9 2.9 0 0 0 .193.08l.118.042.032-.014.029-.077.04-.12.04-.143c.013-.056.028-.112.044-.166Zm4.24.841.013.038.05.138a1.5 1.5 0 0 0 .743.833l.03.014a1.5 1.5 0 0 0 1.136.082l.06-.02a1.47 1.47 0 0 0 .065-.023l.117-.044.062-.025.135-.059.035-.015a2.698 2.698 0 0 1 .415-.16c.268-.078.407-.06.47-.043.057.015.16.056.314.22l.077.09.682.84c.138.185.15.295.15.359 0 .084-.03.267-.225.573l-.082.122-.08.108a4.406 4.406 0 0 0-.18.26l-.014.022-.062.099-.008.013-.01.018-.03.05a1.5 1.5 0 0 0-.178 1.056l.004.017a1.5 1.5 0 0 0 .648.959l.08.052.05.032.11.066.06.034.133.072.034.018c.456.231.62.421.676.516.036.06.084.162.042.417l-.023.117-.207.892c-.066.285-.095.35-.105.369 0 0 0 .003-.01.013a.974.974 0 0 1-.101.103c-.082.074-.166.124-.354.161a2.357 2.357 0 0 1-.257.035l-.153.01-.138.004-.071.002a4.554 4.554 0 0 0-.28.02l-.158.019a1.5 1.5 0 0 0-1.318 1.628l.011.123.008.07.012.083.01.06.028.154.008.045c.05.236.068.419.066.557-.003.206-.046.301-.073.348-.028.046-.094.131-.276.235l-.105.056-.977.471c-.204.088-.317.082-.382.07-.076-.015-.228-.068-.456-.279a2.382 2.382 0 0 1-.08-.076l-.1-.107-.088-.102a4.389 4.389 0 0 0-.217-.236l-.018-.018-.084-.082a1.433 1.433 0 0 0-.036-.034l-.043-.04a1.5 1.5 0 0 0-2.047.014l-.08.075a1.43 1.43 0 0 0-.042.041l-.09.094a1.534 1.534 0 0 0-.048.05l-.103.116-.025.03c-.315.371-.532.495-.646.535-.073.025-.183.05-.415-.038l-.094-.039-.864-.418-.238-.12a1.186 1.186 0 0 1-.13-.083l-.004-.003-.003-.003a1.077 1.077 0 0 1-.083-.147.666.666 0 0 1-.063-.34c.003-.09.015-.207.043-.365l.035-.174a4.384 4.384 0 0 0 .058-.35l.016-.149a1.5 1.5 0 0 0-.434-1.224l-.004-.003a1.5 1.5 0 0 0-.86-.423l-.09-.012a1.405 1.405 0 0 0-.064-.008l-.128-.01a1.539 1.539 0 0 0-.068-.005l-.15-.007-.04-.001a2.663 2.663 0 0 1-.549-.06c-.215-.05-.305-.115-.346-.154-.04-.038-.109-.12-.17-.319l-.03-.114-.242-1.052c-.042-.224-.006-.329.023-.387.038-.076.146-.23.459-.42l.128-.074.119-.063a4.431 4.431 0 0 0 .316-.179l.134-.087a1.5 1.5 0 0 0 .65-.947l.004-.017a1.5 1.5 0 0 0-.171-1.066l-.055-.093a1.49 1.49 0 0 0-.037-.062l-.07-.108a1.496 1.496 0 0 0-.04-.057l-.088-.124a1.516 1.516 0 0 0-.024-.031c-.307-.406-.369-.647-.378-.754-.006-.067-.004-.18.148-.395l.072-.094.684-.838c.154-.173.262-.211.33-.225.09-.018.28-.027.623.1l.138.055.123.055a4.42 4.42 0 0 0 .316.13l.118.042a1.5 1.5 0 0 0 1.134-.058l.031-.015a1.5 1.5 0 0 0 .764-.823l.03-.077.023-.066.04-.12.02-.065.04-.143.01-.037.03-.119c.037-.128.076-.235.114-.323.1-.23.192-.319.243-.357.044-.033.134-.086.343-.105l.1-.006h1.14c.234.01.333.071.386.114.067.056.192.195.308.538l.043.14.034.129c.026.1.056.2.088.298ZM10 11.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Zm0 1.5a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z" clip-rule="evenodd" /></symbol>',20,20,!1,void 0)},197501:(e,t,n)=>{"use strict";n.d(t,{WebStatEvents:()=>d});n(66992),n(241539),n(788674),n(470189),n(333948),n(535666);var r=n(189798),i=n(137395),a=n(248018);function o(e,t,n,r,i,a,o){try{var s=e[a](o),d=s.value}catch(e){return void n(e)}s.done?t(d):Promise.resolve(d).then(r,i)}function s(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function s(e){o(a,r,i,s,d,"next",e)}function d(e){o(a,r,i,s,d,"throw",e)}s(void 0)}))}}var d=new class{constructor(){var e;this.userId="undefined"!=typeof window&&(null==(e=window.vk)?void 0:e.id)||0,this.queue=new Set,this.initialized=!1}setAPI(e){this.api=e}setUserId(e){this.userId=e}add(e){var t=this;return s(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.init();case 2:null!=e.id||(e.id=(0,i.getRandomId)()),null!=e.prev_id||(e.prev_id=null==(r=t.previousEvent)?void 0:r.id),null!=e.timestamp||(e.timestamp=String((0,a.nowMicroseconds)())),"undefined"!=typeof window&&(null!=e.url||(e.url=window.location.href)),e.type_navgo&&t.previousNavigationEvent&&(e.type_navgo.prev_navgo_id=t.previousNavigationEvent.id,e.type_navgo.prev_navgo_timestamp=t.previousNavigationEvent.timestamp),t.previousEvent=e,e.type_navgo&&(t.previousNavigationEvent=e),t.queue.add(e),t.send();case 11:case"end":return n.stop()}}),n)})))()}init(){var e=this;return s(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.initialized){t.next=2;break}return t.abrupt("return");case 2:if(e.initialized=!0,!e.api){t.next=5;break}return t.abrupt("return");case 5:return t.next=7,(0,r.login)("web_token").catch((()=>{}));case 7:if(n=t.sent){t.next=11;break}return e.initialized=!1,t.abrupt("return");case 11:a=n.access_token,e.api=new i.API({token:a}),e.api.onTokenRegenerate(function(){var t=s(regeneratorRuntime.mark((function t(n){var i,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,r.login)("web_token").catch((()=>{}));case 2:if(i=t.sent){t.next=6;break}return e.initialized=!1,t.abrupt("return");case 6:a=i.access_token,n(a);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 14:case"end":return t.stop()}}),t)})))()}send(){this.api&&this.queue.size&&(this.api.statEvents.addWeb({events:JSON.stringify([...this.queue.values()]),user_id:this.userId}),this.queue.clear())}}},248018:(e,t,n)=>{"use strict";n.d(t,{nowMicroseconds:()=>i});var r=performance.timeOrigin||performance.timing.navigationStart||Date.now();function i(){return Math.floor(1e3*(r+performance.now()))}},746408:(e,t,n)=>{"use strict";n.d(t,{default:()=>r});const r={counter:"BadgeCounter-module__counter--RLCgS"}},833223:(e,t,n)=>{"use strict";n.d(t,{default:()=>r});const r={root:"BadgeItem-module__root--NDr99",wrapper:"BadgeItem-module__wrapper--Dk1KX"}},391342:(e,t,n)=>{"use strict";n.d(t,{default:()=>r});const r={root:"BadgeItems-module__root--G6uJV"}},532013:(e,t,n)=>{"use strict";n.d(t,{default:()=>r});const r={items:"BadgesOwnerBlockSkeleton-module__items--j4QSs"}},784637:(e,t,n)=>{"use strict";n.d(t,{default:()=>r});const r={card:"BadgesOwnerInfoCard-module__card--RGQgs",preview:"BadgesOwnerInfoCard-module__preview--PQEuE",title:"BadgesOwnerInfoCard-module__title--fa7Jo",description:"BadgesOwnerInfoCard-module__description--XYkSi",users:"BadgesOwnerInfoCard-module__users--IahmE"}},598872:(e,t,n)=>{"use strict";n.d(t,{default:()=>r});const r={items:"BadgesOwnerInfoModal-module__items--QIXCF",counter:"BadgesOwnerInfoModal-module__counter--G6cIu",body:"BadgesOwnerInfoModal-module__body--GxnQm",settings:"BadgesOwnerInfoModal-module__settings--ERtTg",previewItems:"BadgesOwnerInfoModal-module__previewItems--GUGep",previewItem:"BadgesOwnerInfoModal-module__previewItem--izjjE",preview:"BadgesOwnerInfoModal-module__preview--TOuL8",previewImage:"BadgesOwnerInfoModal-module__previewImage--WCuFZ",previewTitle:"BadgesOwnerInfoModal-module__previewTitle--qSCls",previewDescription:"BadgesOwnerInfoModal-module__previewDescription--bouGo"}},613327:(e,t,n)=>{"use strict";n.d(t,{preservePositionBetween:()=>a});var r=n(830104),i=n(659397);function a(e,t){var n=(void 0===t?{}:t).scrollByImpl,a=void 0===n?window.scrollBy:n,o=e;return{start:(0,i.once)((function(e){e&&(o=e);var t=(0,r.getElementOffset)(o);return(0,i.once)((function(e){if(e&&(o=e),o.isConnected){var n=(0,r.getElementOffset)(o);a(0,n.top-t.top)}}))}))}}},819633:(e,t,n)=>{"use strict";n.d(t,{getAnimationAsync:()=>a,onAnimationReady:()=>o,destroyAnimationItem:()=>s,animationModuleLoaderAsync:()=>d});var r=n(570655),i=function(e){var t=e.animationDataGet,n=e.animationDataSet,r=e.loadAnimation;return function(e,i,a){var o=e,s=t?t({animationId:o}):void 0,d=r({animationData:s,animationURL:e,container:i,loadAnimationParams:null==a?void 0:a.loadAnimationParams});return!s&&n&&function(e,t){e.addEventListener("data_ready",(function(){t(e.animationData)}))}(d,(function(e){n({animationId:o,loadedAnimationData:e})})),d}},a=function(e){var t=e.animationDataGet,n=e.animationDataSet,a=e.animationModuleLoader;return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return a().then((function(a){var o=a.loadAnimation;return i({animationDataGet:t,animationDataSet:n,loadAnimation:o}).apply(void 0,(0,r.__spreadArray)([],(0,r.__read)(e),!1))}))}};function o(e,t){e.isLoaded?t():e.addEventListener("DOMLoaded",(function(){t()}))}function s(e){var t=function(e){return!e._cbs}(e);t||e.destroy()}var d=function(){return Promise.all([n.e(38288),n.e(55489)]).then(n.bind(n,809499)).then((function(e){return{loadAnimation:(t=e.lottie,function(e){var n,i,a=e.animationData,o=e.animationURL,s=e.container,d=e.loadAnimationParams,u=void 0===d?{}:d,c=a?{animationData:a}:{path:o},l={renderer:"svg",autoplay:null!==(n=null==u?void 0:u.autoplay)&&void 0!==n&&n,loop:null===(i=null==u?void 0:u.loop)||void 0===i||i,rendererSettings:{progressiveLoad:!0}},v=(0,r.__assign)((0,r.__assign)((0,r.__assign)({},c),l),{container:s});return t.loadAnimation(v)})};var t}))}},508271:(e,t,n)=>{"use strict";n.d(t,{HIDE_TOOLTIP_TIMEOUT:()=>r,SHOW_TOOLTIP_TIMEOUT:()=>i,REACTION_ID_DEFAULT:()=>a,REACTION_ID_MAX:()=>o,REACTION_ID_MIN:()=>s,REACTION_ID_UNSET:()=>d,REACTION_SET_ITEMS_MIN_COUNT:()=>u,OPENED_REACTED_USERS_DEFAULT_REACTION_ID:()=>c});var r=600,i=140,a=0,o=7,s=0,d=void 0,u=2,c=a},464746:(e,t,n)=>{"use strict";n.d(t,{isDebugEnabled:()=>a});var r=n(593601),i=void 0,a=function(){return void 0!==i?i:i=!!r.default.get("reactions.debug_enabled")}},714396:(e,t,n)=>{"use strict";n.d(t,{reactionCountsBrandUnwrap:()=>i,reactionCountsBrandWrap:()=>a});var r=n(165594),i=function(e){return(0,r.unwrap)(e)},a=function(e){return(0,r.wrap)(e)}},82701:(e,t,n)=>{"use strict";n.d(t,{reactionLogError:()=>i});var r=n(66433);function i(e){var t=e.error,n=e.reportError;void 0!==n&&n&&(0,r.logError)(t,{environment:"reactions"}),console.error(t)}},517760:(e,t,n)=>{"use strict";n.d(t,{isUnknownObject:()=>d,getReaction:()=>u,getDefaultReaction:()=>c,getDefaultReactionTitle:()=>l,prepareReactionMenuSet:()=>g,isReactionIdSet:()=>f,isReactionIdUnset:()=>_,isValidReactionId:()=>p,parseReactionId:()=>m,parseReactionIdOrUnset:()=>w,validateReactionSetPayloaditems:()=>b,parseReactionMenuConfig:()=>h,calcCounters:()=>I,calcCountersSum:()=>y,calcCountersWeightedSum:()=>B,hasReactionsForCounts:()=>S,counterForReactionId:()=>E,areCountersEqual:()=>R});var r=n(570655),i=n(508271),a=n(714396),o=n(659397),s=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},d=function(e){return null!==e&&"object"==typeof e},u=function(e,t){return e.itemsById[t]},c=function(e){return u(e,i.REACTION_ID_DEFAULT)},l=function(e){var t;return null===(t=c(e))||void 0===t?void 0:t.title},v=function(e,t){return 0===e.length?"":(n=e,r=function(e){return Math.pow(t.width-e.width,2)+Math.pow(t.height-e.height,2)},i=!1,void 0===i&&(i=!0),n.reduce((function(e,t){var n=r(t),a=r(e);return a===n?i?e:t:a<n?e:t}))).url;var n,r,i},g=function(e,t,n){var r=t.map((function(e){var t=e.asset,r=e.color_sets,i=e.id,a=e.score,o=e.title;return{animationURL:t.animation_url||void 0,backgroundColor:null==r?void 0:r.background,id:i,imageMenuURL:v(t.images,n.imageMenuSize),imagePreviewURL:"imagePreviewSize"in n?v(t.images,n.imagePreviewSize):void 0,imageStoryPanelURL:"imageStoryPanelSize"in n?v(t.images,n.imageStoryPanelSize):void 0,imageStoryPreviewURL:"imageStoryPreviewSize"in n?v(t.images,n.imageStoryPreviewSize):void 0,score:a,title:o,titleColor:null==r?void 0:r.foreground}})),i={};return r.forEach((function(e){i[e.id]=e})),{id:e,items:r,itemsById:i}},f=function(e){return e!==i.REACTION_ID_UNSET},_=function(e){return e===i.REACTION_ID_UNSET},p=function(e){return s(e)&&e>=i.REACTION_ID_MIN&&e<=i.REACTION_ID_MAX},m=function(e){var t=parseInt(e,10);return p(t)?{isValid:!0,value:t}:{isValid:!1}},w=function(e){var t=m(e);return t.isValid?t.value:i.REACTION_ID_UNSET},b=function(e,t){if(e.length<i.REACTION_SET_ITEMS_MIN_COUNT)return{error:new Error("Invalid reactions items count in set '"+t+"': "+e.length)}},h=function(e){if(d(e)){var t={},n=e.animationShowStaticAfterEnd,r=e.menuShowDelay,a=e.openedDefaultReactionId,o=e.reportJsErrors;return"number"!=typeof r&&void 0!==r||(t.menuShowDelay=r),"boolean"==typeof n&&(t.animationShowStaticAfterEnd=n),"boolean"==typeof o&&(t.reportJsErrors=o),"number"==typeof a||null===a?null===a?t.openedDefaultReactionId=void 0:p(a)&&(t.openedDefaultReactionId=a):t.openedDefaultReactionId=i.OPENED_REACTED_USERS_DEFAULT_REACTION_ID,t}},I=function(e,t){var n=(0,a.reactionCountsBrandWrap)({});return Object.entries((0,a.reactionCountsBrandUnwrap)(e)).forEach((function(e){var i,a,o,s=(0,r.__read)(e,2),d=s[0],u=s[1],c=d,l=null!==(o=null===(a=null===(i=null==t?void 0:t.itemsById)||void 0===i?void 0:i[c])||void 0===a?void 0:a.score)&&void 0!==o?o:1;n[c]=l*(u||0)})),n},y=function(e){return Object.values((0,a.reactionCountsBrandUnwrap)(e)).reduce((function(e,t){return e+(t||0)}),0)},B=function(e){return y((0,a.reactionCountsBrandWrap)(e))},S=function(e){return y(e)>0},E=function(e,t){var n;return null!==(n=e[t])&&void 0!==n?n:void 0},R=function(e,t){return e&&t?(0,o.isEqual)(e,t):e===t}},165594:(e,t,n)=>{"use strict";n.d(t,{unwrap:()=>r,wrap:()=>i});var r=function(e){return e},i=function(e){return e}},404887:(e,t,n)=>{"use strict";n.d(t,{getUserFullName:()=>r});var r=function(e){return e.first_name+" "+e.last_name}},372418:(e,t,n)=>{"use strict";n.d(t,{BadgeCounter:()=>s});var r=n(570655),i=n(785893),a=n(86894),o=n(746408),s=function(e){var t=(0,r.__rest)(e,[]);return(0,i.jsx)(a.Counter,(0,r.__assign)({className:o.default.counter,mode:"inherit"},t),void 0)}},22340:(e,t,n)=>{"use strict";n.d(t,{BadgeSenderItem:()=>l});var r=n(570655),i=n(785893),a=n(197501),o=n(86894),s=n(608021),d=n(342269),u=n(799336),c=n(404887);function l(e){var t=e.entry,n=e.user,l=n.id,v=n.first_name,g=n.last_name,f=n.domain,_=n.photo_100,p=n.photo_200,m=(0,r.__rest)(e,["entry","user"]),w=(0,c.getUserFullName)({first_name:v,last_name:g}),b=((0,d.isRetina)()?p:_)||_||"",h=null;return t.object_description&&(h=(0,u.parseReactWikiLinks)(t.object_description,{target:"_blank"})),h=(0,i.jsxs)(i.Fragment,{children:[h,(0,i.jsx)("br",{},void 0),(0,s.getLang)("awards_private_text")]},void 0),(0,i.jsx)(o.RichCell,(0,r.__assign)({before:(0,i.jsx)(o.Avatar,{size:100,src:b,title:w},void 0),caption:h,href:f?"/"+f:void 0,target:"_blank",onClick:function(){a.WebStatEvents.add({screen:"badge",type:"type_click",type_click:{type:"type_badges_screen_item",item:{type:"badges",id:l},type_badges_screen_item:{type_badges_event:{event_name:"open_sender"}}}})}},m,{children:w}),void 0)}},590790:(e,t,n)=>{"use strict";n.d(t,{BadgeItemWrapper:()=>d,BadgeItem:()=>u});var r=n(570655),i=n(785893),a=n(334606),o=n(372418),s=n(833223),d=function(e){var t=e.children;return(0,i.jsx)("div",(0,r.__assign)({className:s.default.wrapper},{children:t}),void 0)},u=function(e){var t=e.badge,n=e.counter;if(!t)return null;var u=(0,a.getBadgeImage)(t.image,128);return(0,i.jsx)(d,{children:(0,i.jsx)("div",(0,r.__assign)({style:{backgroundImage:"url('"+u+"')"},className:s.default.root},{children:(0,i.jsx)(o.BadgeCounter,(0,r.__assign)({size:"s"},{children:n}),void 0)}),void 0)},void 0)}},814672:(e,t,n)=>{"use strict";n.d(t,{BadgeItems:()=>u});var r=n(570655),i=n(785893),a=n(667294),o=n(86894),s=n(590790),d=n(391342),u=function(e){var t=e.counters,n=e.badges,u=e.onClick,c=(0,a.useMemo)((function(){return((null==t?void 0:t.filter((function(e){return"total"!==e.type})))||[]).map((function(e){var t=e.value,r=e.badge_id;if(!r)return null;var a=n.find((function(e){var t=e.id;return r===t}));return(0,i.jsx)(s.BadgeItem,{counter:t,badge:a},r)}))}),[t,n]);return(0,i.jsx)(o.HorizontalScroll,(0,r.__assign)({arrowSize:"m"},{children:(0,i.jsx)("div",(0,r.__assign)({className:d.default.root,onClick:u,tabIndex:0,role:"button"},{children:c}),void 0)}),void 0)}},933275:(e,t,n)=>{"use strict";n.d(t,{BadgesOwnerBlockSkeleton:()=>v});var r=n(570655),i=n(785893),a=n(667294),o=n(495882),s=n(86894),d=n(659397),u=n(590790),c=n(532013),l=(0,d.createArray)(4),v=function(e){var t=(0,a.useMemo)((function(){return l.map((function(e,t){return(0,i.jsx)(u.BadgeItemWrapper,{children:(0,i.jsx)(o.Skeleton,{width:56,height:56,circle:!0},void 0)},t)}))}),[56,4]);return(0,i.jsx)(s.Group,(0,r.__assign)({header:(0,i.jsx)(s.Header,{children:(0,i.jsx)(o.Skeleton,{width:192},void 0)},void 0)},e,{children:(0,i.jsx)("div",(0,r.__assign)({className:c.default.items},{children:t}),void 0)}),void 0)}},999386:(e,t,n)=>{"use strict";n.d(t,{BadgesOwnerInfoCard:()=>c});var r=n(570655),i=n(785893),a=n(86894),o=n(70162),s=n(334606),d=n(372418),u=n(784637),c=function(e){var t=e.badge,n=e.counter,c=e.recentSenderUsers,l=e.sendersCount,v=e.onClick,g=null==c?void 0:c.slice(0,3).map((function(e){var t=e.photo_200;return String(t)}));return(0,i.jsxs)(a.Tappable,(0,r.__assign)({className:u.default.card,onClick:v},{children:[(0,i.jsx)("div",(0,r.__assign)({className:u.default.preview,"aria-label":t.title,style:{backgroundImage:"url('"+(0,s.getBadgeImage)(t.image,128)+"')"}},{children:(0,i.jsx)(d.BadgeCounter,{children:n},void 0)}),void 0),(0,i.jsx)(a.Title,(0,r.__assign)({className:u.default.title,level:"2",weight:"1"},{children:t.title}),void 0),(0,i.jsx)(a.Text,(0,r.__assign)({className:u.default.description,weight:"3"},{children:t.description}),void 0),Boolean(c.length)&&(0,i.jsx)("div",(0,r.__assign)({className:u.default.users},{children:(0,i.jsx)(a.UsersStack,(0,r.__assign)({size:"m",photos:g},{children:(0,o.getLang)("awards_senders_count",l).replace("{count}",String(l))}),void 0)}),void 0)]}),void 0)}},521518:(e,t,n)=>{"use strict";n.d(t,{BadgesOwnerInfoModal:()=>S});var r=n(570655),i=n(785893),a=n(667294),o=n(844142),s=n(189798),d=n(197501),u=n(420637),c=n(961943),l=n(86894),v=n(531286),g=n(809177),f=n(623122),_=n(651024),p=n(999386),m=n(22340),w=n(372418),b=n(226323),h=n(70162),I=n(334606),y=n(254581),B=n(598872),S=function(e){function t(t){var n=e.call(this,t)||this;n.selectBadge=function(e){e&&d.WebStatEvents.add({screen:"badge",type:"type_navgo",type_navgo:{type:"type_badges_screen_item",subtype:"go",item:{type:"badges",id:e,owner_id:n.props.ownerId},type_badges_screen_item:{type_badges_event:{event_name:"open_badges_collection_badge__"+(o.Ranges.isUserId(n.props.ownerId)?"u":"c")}}}}),n.setState({currentBadgeId:e})};var r=t.isAdmin,i=void 0!==r&&r;return n.state={isOwnerInfoLoaded:!1,totalCount:0,counters:[],badges:{},users:{},currentBadgeId:null,loadedBadgeEntries:{},isAdmin:i},n}return(0,r.__extends)(t,e),t.prototype.componentDidMount=function(){d.WebStatEvents.add({screen:"badge",type:"type_navgo",type_navgo:{type:"type_badges_screen_item",subtype:"go",item:{type:"badges",owner_id:this.props.ownerId},type_badges_screen_item:{type_badges_event:{event_name:"open_badges_collection_all__"+(o.Ranges.isUserId(this.props.ownerId)?"u":"c")}}}}),this.fetchOwnerInfo()},t.prototype.componentDidUpdate=function(){var e=this.state.currentBadgeId;e&&!this.getBadgeEntries(e)&&this.fetchOwnerEntries()},t.prototype.fetchOwnerInfo=function(){var e=this,n=this.props.ownerId;(0,s.api)("badges.getOwnerInfo",{owner_id:n,with_senders:1,fields:"photo_100,photo_200,domain"}).then((function(n){var r,i=n.owner_info,a=n.badges,o=n.users;e.setState({isOwnerInfoLoaded:!0,totalCount:(null===(r=((null==i?void 0:i.counters)||[]).find((function(e){return"total"===e.type})))||void 0===r?void 0:r.value)||0,counters:((null==i?void 0:i.counters)||[]).filter((function(e){return"total"!==e.type})),badges:t.convertBadges(a||[]),users:t.convertUsers(o||[])})})).catch((function(t){var n;e.props.close(),(0,b.topError)((null===(n=null==t?void 0:t.error)||void 0===n?void 0:n.error_msg)||(0,h.getLang)("global_unknown_error"))}))},t.prototype.fetchOwnerEntries=function(){var e=this,n=this.props.ownerId,i=this.state,a=i.loadedBadgeEntries,o=i.currentBadgeId;if(o){var d=this.getBadgeEntries(o),u={fields:"photo_100,photo_200,domain"};(null==d?void 0:d.next_query)?Object.assign(u,{query:d.next_query}):Object.assign(u,{owner_id:n,badge_id:o,count:100}),(0,s.api)("badges.getOwnerEntries",u).then((function(n){var i,s=n.entries,u=n.badges,c=n.next_query,l=n.users;e.setState({users:(0,r.__assign)((0,r.__assign)({},e.state.users),t.convertUsers(l||[])),badges:(0,r.__assign)((0,r.__assign)({},e.state.badges),t.convertBadges(u||[])),loadedBadgeEntries:(0,r.__assign)((0,r.__assign)({},a),(i={},i[o]={entries:(0,r.__spreadArray)((0,r.__spreadArray)([],(0,r.__read)((null==d?void 0:d.entries)||[]),!1),(0,r.__read)(s||[]),!1),next_query:c},i))})})).catch((function(t){var n;e.props.close(),(0,b.topError)((null===(n=null==t?void 0:t.error)||void 0===n?void 0:n.error_msg)||(0,h.getLang)("global_unknown_error"))}))}},t.prototype.renderHeader=function(){var e,t,n=this,a=this.state,s=a.isOwnerInfoLoaded,d=a.currentBadgeId,f=a.isAdmin,_=this.props.ownerId;return(0,i.jsx)(v.ModalHeader,(0,r.__assign)({closeAriaLabel:(0,h.getLang)("awards_back_button"),onClose:this.props.close,before:s&&d&&(0,i.jsxs)(g.ModalHeaderButton,(0,r.__assign)({"aria-label":(0,h.getLang)("awards_back_button"),onClick:function(){return n.selectBadge(null)}},{children:[(0,i.jsx)(u.default,{},void 0),(0,h.getLang)("awards_back_button")]}),void 0),after:f&&(0,i.jsx)(l.Link,(0,r.__assign)({className:B.default.settings,href:(t=location.protocol+"//"+window.vk.host,o.Ranges.isGroupId(_)?(e=new URL("public"+Math.abs(_),t)).searchParams.set("act","sections"):((e=new URL("settings",t)).searchParams.set("act","privacy"),e.searchParams.set("hl","badges")),e.toString()),target:"_blank"},{children:(0,i.jsx)(c.default,{},void 0)}),void 0)},{children:s&&!d?this.renderHeaderTitle():null}),void 0)},t.prototype.renderHeaderTitle=function(){var e=this.props.ownerId,t=this.state.totalCount,n=t>0?(0,i.jsx)("span",(0,r.__assign)({className:B.default.counter},{children:t}),void 0):null;return(0,i.jsxs)(i.Fragment,{children:[e===window.vk.id?(0,h.getLang)("awards_my_badges"):(0,h.getLang)("awards_profile_block_header")," ",n]},void 0)},t.prototype.renderContent=function(){var e=this,t=this.state,n=t.counters;return t.currentBadgeId?this.renderBadgeInfo():(0,i.jsx)("div",(0,r.__assign)({className:B.default.items},{children:n.map((function(t,n){var r=t.badge_id,a=t.value,o=t.recent_sender_ids,s=t.senders_count;return(0,i.jsx)(p.BadgesOwnerInfoCard,{badge:e.getBadgeById(r||0),counter:a,recentSenderUsers:e.getUsersById(o||[]),sendersCount:s||0,onClick:function(){return e.selectBadge(r||null)}},n)}))}),void 0)},t.prototype.renderBadgeInfo=function(){var e,t,n=this,a=this.state,o=a.currentBadgeId,s=a.counters,d=this.getBadgeEntries(o||0),u=this.getBadgeById(o||0),c=(null===(e=s.find((function(e){return e.badge_id===o})))||void 0===e?void 0:e.value)||0;return d?(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",(0,r.__assign)({className:B.default.preview},{children:[(0,i.jsx)("div",(0,r.__assign)({className:B.default.previewImage,"aria-label":u.title,style:{backgroundImage:"url('"+(0,I.getBadgeImage)(u.image,100)+"')"}},{children:(0,i.jsx)(w.BadgeCounter,{children:c},void 0)}),void 0),(0,i.jsxs)("div",{children:[(0,i.jsx)(l.Title,(0,r.__assign)({className:B.default.previewTitle,level:"2",weight:"2"},{children:u.title}),void 0),(0,i.jsx)(l.Text,(0,r.__assign)({className:B.default.previewDescription,weight:"3"},{children:u.description}),void 0)]},void 0)]}),void 0),(0,i.jsx)(l.Spacing,{size:25},void 0),(0,i.jsx)(l.Separator,{},void 0),(0,i.jsx)(l.Spacing,{size:25},void 0),(0,i.jsx)(y.ReexportInfiniteScroll,(0,r.__assign)({className:B.default.previewItems,hasMore:Boolean(d.next_query),loadMore:this.fetchOwnerEntries},{children:null===(t=d.entries)||void 0===t?void 0:t.map((function(e,t){var r=e.sender_id;return r?(0,i.jsx)(m.BadgeSenderItem,{className:B.default.previewItem,entry:e,user:n.getUserById(r)},t):null}))}),void 0)]},void 0):(0,i.jsx)(l.Spinner,{},void 0)},t.prototype.getBadgeById=function(e){return this.state.badges[e]},t.prototype.getUserById=function(e){return this.state.users[e]},t.prototype.getUsersById=function(e){var t=this;return e.map((function(e){return t.getUserById(e)}))},t.prototype.getBadgeEntries=function(e){return this.state.loadedBadgeEntries[e]},t.convertBadges=function(e){return e.reduce((function(e,t){var n;return(0,r.__assign)((0,r.__assign)({},e),((n={})[t.id]=t,n))}),{})},t.convertUsers=function(e){return e.reduce((function(e,t){var n;return(0,r.__assign)((0,r.__assign)({},e),((n={})[t.id]=t,n))}),{})},t.prototype.render=function(){var e=this.state.isOwnerInfoLoaded;return(0,i.jsxs)(f.ModalBox,{children:[this.renderHeader(),(0,i.jsx)(l.CustomScrollView,{children:(0,i.jsx)(_.ModalBody,(0,r.__assign)({className:B.default.body},{children:e?this.renderContent():(0,i.jsx)(l.Spinner,{},void 0)}),void 0)},void 0)]},void 0)},t}(a.Component)},522581:(e,t,n)=>{"use strict";n.d(t,{GroupBadges:()=>m});var r=n(570655),i=n(785893),a=n(667294),o=n(86894),s=n(99656),d=n(832678),u=n(189798),c=n(629401),l=n(70162),v=n(814672),g=n(163703),f=n(371063),_=n(452645),p=n(464284),m=(0,g.withErrorBoundary)((function(e){var t,n,g,m=e.ownerId,w=e.isAdmin,b=(0,r.__read)((0,a.useState)(),2),h=b[0],I=b[1],y=(0,r.__read)((0,a.useState)(d.LoadingStatus.pending),2),B=y[0],S=y[1];if((0,a.useEffect)((function(){S(d.LoadingStatus.pending),(0,u.api)("badges.getOwnerInfo",{fields:String(["photo_100","photo_200","domain"]),owner_id:m}).then(I).then((function(){S(d.LoadingStatus.loaded)})).catch((function(e){S(d.LoadingStatus.failed),(0,_.badgesLogger)("Failed badges.getOwnerInfo in GroupBadges",e)}))}),[m]),B!==d.LoadingStatus.loaded&&B!==d.LoadingStatus.failed)return(0,i.jsx)(f.BadgesOwnerBlockSkeleton,{separator:"hide"},void 0);if(!(null===(t=null==h?void 0:h.badges)||void 0===t?void 0:t.length)||B===d.LoadingStatus.failed)return null;var E=h.badges,R=h.owner_info,L=(null===(g=null===(n=null==R?void 0:R.counters)||void 0===n?void 0:n.find((function(e){return"total"===e.type})))||void 0===g?void 0:g.value)||0,C=function(){(0,c.initBadgesOwnerInfo)({ownerId:m,isAdmin:w})};return(0,i.jsx)(s.AppRootProvider,(0,r.__assign)({viewWidth:o.ViewWidth.DESKTOP},{children:(0,i.jsx)(o.Group,(0,r.__assign)({header:(0,i.jsx)(p.PageBlockHeader,(0,r.__assign)({indicator:L,onClick:C},{children:(0,l.getLang)("awards_profile_block_header")}),void 0),separator:"hide"},{children:(0,i.jsx)(v.BadgeItems,{badges:E,counters:null==R?void 0:R.counters,onClick:C},void 0)}),void 0)}),void 0)}))},163703:(e,t,n)=>{"use strict";n.d(t,{withErrorBoundary:()=>u});var r=n(570655),i=n(785893),a=n(667294),o=n(86894),s=n(70162),d=n(452645);function u(e){return function(t){return(0,i.jsx)(c,{children:(0,i.jsx)(e,(0,r.__assign)({},t),void 0)},void 0)}}var c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={hasError:!1,isReloading:!1},t.onClick=function(){t.setState({isReloading:!0}),window.nav.reload({force:!0})},t}return(0,r.__extends)(t,e),t.getDerivedStateFromError=function(){return{hasError:!0}},t.prototype.componentDidCatch=function(e){(0,d.badgesLogger)("Rendering error has happened in component GroupBadges",e)},t.prototype.render=function(){return this.state.hasError?(0,i.jsx)(o.Group,(0,r.__assign)({separator:"hide"},{children:(0,i.jsx)(o.Placeholder,(0,r.__assign)({header:(0,s.getLang)("global_error"),action:(0,i.jsx)(o.Button,(0,r.__assign)({mode:"tertiary",loading:this.state.isReloading,onClick:this.onClick},{children:(0,s.getLang)("global_reload")}),void 0)},{children:(0,s.getLang)("awards_group_block_unknown_error")}),void 0)}),void 0):this.props.children},t}(a.Component)},371063:(e,t,n)=>{"use strict";n.r(t),n.d(t,{BadgesOwnerInfo:()=>c,BadgesOwnerBlockSkeleton:()=>d.BadgesOwnerBlockSkeleton,GroupBadges:()=>u.GroupBadges});var r=n(785893),i=n(521518),a=n(452645),o=n(856330),s=n(832678),d=n(933275),u=n(522581),c={init:function(e,t){e?(0,o.showMessageBoxModal)((function(n){var a=n.onClose;return(0,r.jsx)(i.BadgesOwnerInfoModal,{ownerId:e,isAdmin:t,close:a},void 0)}),{width:s.BADGES_BOX_WIDTH}):(0,a.badgesLogger)("Wrong arguments: ownerId="+e)}}},832678:(e,t,n)=>{"use strict";n.d(t,{BADGES_BOX_WIDTH:()=>a,LINK_TO_HELP_FOR_AUTHORS:()=>o,ERRORS:()=>r,BadgesEventRef:()=>i,BADGE_COMMENT_SELECTOR:()=>d,LoadingStatus:()=>s});var r,i,a=640,o="/@authors-badges";!function(e){e[e.ERROR_PARAM=100]="ERROR_PARAM",e[e.NEED_CONFIRMATION=24]="NEED_CONFIRMATION",e[e.BALANCE=504]="BALANCE"}(r||(r={})),function(e){e.TAB="tab",e.SENDER_LIST="sender_list"}(i||(i={}));var s,d="BadgeComment";!function(e){e[e.pending=0]="pending",e[e.loaded=1]="loaded",e[e.failed=2]="failed"}(s||(s={}))},334606:(e,t,n)=>{"use strict";n.d(t,{getBadgeImage:()=>o,getBadgesStackHTMLForPost:()=>s,buildHtmlAttributesString:()=>d});var r=n(570655),i=n(342269),a=n(873589);function o(e,t,n){void 0===n&&(n=!1);var r=e.base_url,a=e.version,o=a?"?"+a:"";return!n&&(0,i.isRetina)()&&(t*=2),r+"/"+t+".png"+o}function s(e,t,n){return n?(0,a.rs)(n,{object_owner_id:e,object_id:t}):""}var d=function(e){return Object.entries(e).reduce((function(e,t){var n=(0,r.__read)(t,2),a=n[0],o=n[1];o&&(e+=" "+a+'="'+(0,i.escapeAttr)(String(o))+'"');return e}),"")}},254581:(e,t,n)=>{"use strict";n.d(t,{ReexportInfiniteScroll:()=>r});var r=n(468916).default},380401:(e,t,n)=>{"use strict";n.d(t,{tqOpenBadgesObjectInfo:()=>c,initBadgesTqInteractiveHandlers:()=>l,initGroupBadgesTq:()=>v});var r=n(785893),i=n(182804),a=n(629401),o=n(973935),s=n(371063),d=n(45722),u=n(997109),c=function(){(0,i.tq)().setInteractiveHandler("Badges/openBadgesObjectInfo",(function(e){if(e.payload.dataAttrs){var t=e.payload.dataAttrs,n=t.badgeId,r=t.objectType,i=t.objectOwnerId,o=t.objectId;if(!r||!i||!o)throw new Error("No required attributes in tq Badges/openBadgesObjectInfo");(0,a.initBadgesObjectInfo)(Number(r),Number(i),Number(o),Number(n))}}))},l=function(){c(),(0,i.tq)().setInteractiveHandler("Badges/openBadgesCatalog",(function(e){if(e.payload.dataAttrs){var t=e.payload.dataAttrs,n=t.objectType,r=t.objectOwnerId,i=t.objectId,o=t.eventRef;if(!n||!r||!i)throw new Error("No required attributes in tq Badges/openBadgesCatalog");(0,a.initBadgesCatalog)(Number(n),Number(r),Number(i),o)}}))},v=function(){(0,i.tq)().setStartupHandler("BadgesOwner/render_group_badges",(function(e){var t=e.payload,n=t.data,i=n.owner_id,a=n.is_admin,c=t.target;c&&void 0!==i&&(0,d.isBadgesEnabled)()&&(o.render((0,r.jsx)(s.GroupBadges,{ownerId:Number(i),isAdmin:Boolean(a)},void 0),c),(0,u.pushNavDestroy)((function(){return o.unmountComponentAtNode(c)})))}))}},629401:(e,t,n)=>{"use strict";n.d(t,{initBadgesTqInteractiveHandlers:()=>s.initBadgesTqInteractiveHandlers,initBadgesCatalog:()=>d,initBadgesObjectInfo:()=>u,initBadgesOwnerInfo:()=>c,loadBadgesWallOnboarding:()=>l});var r=n(452645),i=n(659397),a=n(45722),o=n(501389),s=n(380401),d=function(e,t,s,d){(0,a.isBadgesEnabled)()&&((0,o.showBoxLoader)(),(window.BadgesCatalog?Promise.resolve():(0,i.asyncImportLoader)((function(){return Promise.all([n.e(76429),n.e(56990),n.e(98066),n.e(68592),n.e(18669)]).then(n.bind(n,281172))})).then((function(e){var t=e.BadgesCatalog;window.BadgesCatalog=t}))).then((function(){return window.BadgesCatalog.init(e,t,s,d)})).catch((function(e){(0,r.badgesLogger)("Error loading module BadgesCatalog",e)})).finally((function(){(0,o.hideBoxLoader)()})))},u=function(e,t,s,d,u){(0,a.isBadgesEnabled)()&&((0,o.showBoxLoader)(),(window.BadgesObjectInfo?Promise.resolve():(0,i.asyncImportLoader)((function(){return Promise.all([n.e(76429),n.e(98066),n.e(68592),n.e(83803)]).then(n.bind(n,474859))})).then((function(e){var t=e.BadgesObjectInfo;window.BadgesObjectInfo=t}))).then((function(){return window.BadgesObjectInfo.init(e,t,s,d,u)})).catch((function(e){(0,r.badgesLogger)("Error loading module BadgesObjectInfo",e)})).finally((function(){(0,o.hideBoxLoader)()})))},c=function(e){if((0,a.isBadgesEnabled)()){(0,o.showBoxLoader)();var t=e.ownerId,s=e.isAdmin;(window.BadgesOwnerInfo?Promise.resolve():(0,i.asyncImportLoader)((function(){return Promise.resolve().then(n.bind(n,371063))})).then((function(e){var t=e.BadgesOwnerInfo;window.BadgesOwnerInfo=t}))).then((function(){return window.BadgesOwnerInfo.init(t,s)})).catch((function(e){(0,r.badgesLogger)("Error loading module BadgesOwnerInfo",e)})).finally((function(){(0,o.hideBoxLoader)()}))}},l=function(e){var t=e.target;(0,a.isBadgesEnabled)()&&(0,i.asyncImportLoader)((function(){return Promise.all([n.e(76429),n.e(9603)]).then(n.bind(n,464329))})).then((function(e){(0,e.initBadgesWallOnboarding)({target:t})})).catch((function(e){(0,r.badgesLogger)("Error loading module badges_wall_onboarding_init",e)}))}},452645:(e,t,n)=>{"use strict";n.d(t,{badgesLogger:()=>i});var r=n(66433),i=function(e,t){window.vk.dev&&console.log(t),(0,r.logError)(new Error(e),{environment:"badges"})}},45722:(e,t,n)=>{"use strict";n.d(t,{isBadgesEnabled:()=>i});var r=n(506770),i=function(){return(0,r.partConfigEnabled)("web2_badges")&&(0,r.partConfigEnabled)("badges")}},464284:(e,t,n)=>{"use strict";n.d(t,{PageBlockHeader:()=>o});var r=n(570655),i=n(785893),a=n(86894),o=function(e){var t=e.href,n=e.onClick,o=e.children,s=(0,r.__rest)(e,["href","onClick","children"]);return(0,i.jsx)(i.Fragment,{children:t||n?(0,i.jsx)(a.Tappable,(0,r.__assign)({href:t,onClick:n,hasActive:!0,hasHover:!1},{children:(0,i.jsx)(a.Header,(0,r.__assign)({},s,{children:o}),void 0)}),void 0):(0,i.jsx)(a.Header,(0,r.__assign)({},s,{children:o}),void 0)},void 0)}},964141:(e,t,n)=>{"use strict";n.d(t,{stripPercentVars:()=>r});var r=function(e){return e.replace(/%[-\w]+%/g,"")}},465864:(e,t,n)=>{"use strict";n.d(t,{parseLikeObjectId:()=>i,likePostObjectId:()=>a,likeReplyObjectId:()=>o,getElementLikeButtonCount:()=>s,getElementLikeButtonIcon:()=>d,getElementLikeButtonLabel:()=>u});var r=n(570655);function i(e){var t=e.match(/^([a-z_]+)([0-9\-_]+)$/);if(!t)return null;var n=(0,r.__read)(t,3);return{objectType:n[1],objectId:n[2]}}var a=function(e){return"wall"+e},o=function(e){return"wall_reply"+e},s=function(e){var t;return null!==(t=null==e?void 0:e.querySelector(".like_button_count, ._like_button_count"))&&void 0!==t?t:void 0},d=function(e){var t;return null!==(t=null==e?void 0:e.querySelector(".like_button_icon, ._like_button_icon"))&&void 0!==t?t:void 0},u=function(e){var t;return null!==(t=e.querySelector(".like_button_label, ._like_button_label"))&&void 0!==t?t:void 0}},93682:(e,t,n)=>{"use strict";n.d(t,{ATTR_USER_REACTION_ID:()=>r});var r="data-reaction-user-reaction-id"},330752:(e,t,n)=>{"use strict";n.d(t,{updateReactionButtonContainerForCounts:()=>y,updateReactionButtonForCurrentReaction:()=>B,updateReactionButtonCounts:()=>S,getLastOwnReactionChangeTime:()=>E,setDataCurrentId:()=>R});var r=n(570655),i=n(733164),a=(n(830104),n(70162)),o=n(819633),s=n(464746),d=n(517760),u=n(873589),c=n(631351),l=n(93682),v=n(646346),g=n(808591),f=n(672544),_=n(385667),p="data-reaction-last-own-change-time",m="PostButtonReactions__icon--animationActive";var w=function(e){var t,n=null===(t=e.__reactionIconAnimation)||void 0===t?void 0:t.animationItem;n&&(!n._cbs||n.destroy(),delete e.__reactionIconAnimation)},b=function(e,t,n,i){return(0,r.__awaiter)(void 0,void 0,Promise,(function(){var a,s,d;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return!(e!==(null===(d=n.__reactionIconAnimation)||void 0===d?void 0:d.animationURL))&&e||(w(n),t.innerHTML="",n.classList.remove(m)),i&&e?[4,(0,v.getAnimationAsync)(e,t,{loadAnimationParams:{autoplay:!0,loop:!1}})]:[2];case 1:return a=r.sent(),(0,o.onAnimationReady)(a,(function(){n.classList.add(m)})),s=function(){var e;!0===(null==(e=(0,_.getReactionConfig)())?void 0:e.animationShowStaticAfterEnd)&&(n.classList.remove(m),w(n))},a.addEventListener("complete",s),n.__reactionIconAnimation={animationItem:a,animationURL:e},[2]}}))}))},h=function(e,t){var n=e.querySelector('[data-section-ref="reactions-button-icon"]');if(n){var r=t.currentOption,i=t.isUserAction;if(r.isReactionSet){var a=r.current,o=null==a?void 0:a.imageMenuURL;n.style.backgroundImage="url('"+o+"')",n.setAttribute("aria-label",null==a?void 0:a.title)}else{var s=r.default;n.style.backgroundImage="",(null==s?void 0:s.title)&&n.setAttribute("aria-label",null==s?void 0:s.title)}n.classList.toggle("PostButtonReactions__icon--custom",r.isReactionSet);var d=r.isReactionSet?r.current.animationURL:void 0,c=function(e){var t=e.querySelector(".PostButtonReactions__iconAnimation");return t||(t=(0,u.se)('<div class="PostButtonReactions__iconAnimation" data-section-ref="reactions-button-icon-animation"></div>'),e.appendChild(t),t)}(n);b(d,c,n,i)}},I=function(e,t,n){e.classList.toggle("PostButtonReactions--icon-active",t),e.classList.toggle("PostButtonReactions--active",t)},y=function(e,t){var n=!t||!(0,d.hasReactionsForCounts)(t);e.classList.toggle("PostBottomAction--empty",n)},B=function(e,t,n,i){var o=!(0,d.isReactionIdUnset)(t),u=function(e,t){var n=(0,d.getDefaultReaction)(e),r=void 0;if((0,d.isReactionIdUnset)(t)){if(n)return{isReactionSet:!1,default:n}}else{if(r=e.itemsById[t])return{isReactionSet:!0,current:r};console.error(new Error("Missing reaction meta for "+t+" in set '"+e.id+"'"))}return{_error:!0}}(n,t);"_error"in u||(h(e,{currentOption:u,isUserAction:i}),function(e,t){var n=t.currentOption,i=n.isReactionSet?n.current.titleColor:void 0,a=n.isReactionSet?n.current.backgroundColor:void 0,o=i?{"--reaction-button-title-color-light":i.light,"--reaction-button-title-color-dark":i.dark}:{"--reaction-button-title-color-light":null,"--reaction-button-title-color-dark":null},s=a?{"--reaction-button-background-color-light":a.light,"--reaction-button-background-color-dark":a.dark}:{"--reaction-button-background-color-light":null,"--reaction-button-background-color-dark":null},d=(0,r.__assign)((0,r.__assign)({},o),s);Object.entries(d).forEach((function(t){var n=(0,r.__read)(t,2),i=n[0],a=n[1];e.style.setProperty(i,a)}))}(e,{currentOption:u}),function(e,t){var n=t.currentOption,r="";r=n.isReactionSet?(0,a.langReplace)((0,a.getLang)("reactions_button_unset_reaction_title")||"",{reaction_name:n.current.title||""}):(0,a.langReplace)((0,a.getLang)("reactions_button_set_reaction_with_name")||"",{reaction_name:n.default.title||""})||(0,a.getLang)("reactions_button_title")||"",e.setAttribute("aria-label",r||"")}(e,{currentOption:u}),(0,g.isCounterEnabledForBtn)(e)||function(e,t){var n=e.querySelector('[data-section-ref="reactions-button-title"]');if(n){var r=t.currentOption,i=r.isReactionSet?r.current.title:r.default.title;i?n.innerText=i:(0,s.isDebugEnabled)()&&console.log("reactions: setReactionNameTitle: missing title",r)}}(e,{currentOption:u})),I(e,o),i&&function(e,t){e.setAttribute(p,String(t))}(e,Date.now())},S=function(e,t,n,r,i){var o=(0,g.getCounterForTitle)(e,t,r,i);(0,g.isCounterEnabled)(o)&&(function(e,t){var n=e.querySelector('[data-section-ref="reactions-button-title"]');if(n){var r=t.counterForTitle;if((0,g.isCounterAvailable)(r)){var i=r.buttonText;(0,c.animateCount)(n,i,{allowZero:r.allowZeroAnimation,str:!0,noWrapWidth:!0,noSpaceIfEmpty:!0})}else(0,s.isDebugEnabled)()&&console.log("reactions: setReactionTitle: missing title",r)}}(e,{counterForTitle:o}),r&&function(e,t){var n,r=null===(n=(0,f.getClosestLikeBtnContainerElem)(e))||void 0===n?void 0:n.querySelector('[data-section-ref="reactions-button-screen-reader-counter"]');if(r){var i=(0,a.langNumeric)(t,(0,a.getLang)("reactions_n_reacted","raw")||"%s",!0);r.innerText=i}}(e,(0,d.calcCountersSum)(r)))},E=function(e){var t=e.getAttribute(p);if(t&&(0,i.isNumeric)(t))try{return new Date(Number.parseInt(t)).getTime()||void 0}catch(e){return void console.error(e)}};var R=function(e,t){e.setAttribute(l.ATTR_USER_REACTION_ID,(0,d.isReactionIdUnset)(t)?"":String(t))}},1925:(e,t,n)=>{"use strict";n.d(t,{TitleVariantWithLikedUsers:()=>r,TITLE_VARIANT_DEFAULT:()=>i,ReactionMenuTitleVariants:()=>a});var r="WithLikedUsers",i=r,a=[r,"TitleOnly"]},54789:(e,t,n)=>{"use strict";n.d(t,{ButtonStyleVariant:()=>r});var r={Post:"post",Reply:"reply"}},52521:(e,t,n)=>{"use strict";n.d(t,{renderPreviewItems:()=>l});var r=n(570655),i=n(517760),a=n(483295),o=n(873589),s=n(428817),d=n.n(s),u=n(54789),c=n(385667),l=function(e,t,n,s,l){var v=function(e,t,n){var a,o;void 0===n&&(n=!1);var s=[];try{for(var d=(0,r.__values)(Object.keys(e)),u=d.next();!u.done;u=d.next()){var c=u.value,l=(0,i.parseReactionId)(c);l.isValid&&e[l.value]>0&&s.push(l.value)}}catch(e){a={error:e}}finally{try{u&&!u.done&&(o=d.return)&&o.call(d)}finally{if(a)throw a.error}}return s=s.sort((function(t,n){return(e[n]||0)-(e[t]||0)})).slice(0,t),n&&s.reverse(),s}(t,3),g=e.querySelector(".ReactionsPreview__items"),f=(0,c.getReactionSet)(n),_=0===(0,i.calcCountersSum)(t),p=d().reactions_preview_item;g&&f&&"string"==typeof p?(g.innerHTML=v.map((function(e){var t=f.itemsById[e];if(!t)return"";var n=(0,a.classNames)({"ReactionsPreviewItem--lite ReactionsPreviewItem--stackOverlayLite":l===u.ButtonStyleVariant.Reply,"ReactionsPreviewItem--post ReactionsPreviewItem--stackOverlayPost":l===u.ButtonStyleVariant.Post});return(0,o.rs)(p,{image_url:t.imagePreviewURL,title:t.title,class:n})})).join(""),e.classList.toggle("ReactionsPreview--empty",_),e.classList.toggle("ReactionsPreview--active",void 0!==s)):console.warn("Unable to render reaction previews",{itemsContainer:g,previewItemTemplate:p,reactionSet:f})}},908706:(e,t,n)=>{"use strict";n.d(t,{isVariantInActionStatusBar:()=>i,isVariantHidden:()=>a,previewVisibilityUseCurrent:()=>o,isIntentPreviewInActionStatusBar:()=>s,isIntentPreviewHidden:()=>d,isIntentPreviewUseCurrent:()=>u,previewVisibilityIntentForVariant:()=>c,parsePreviewVariant:()=>l});var r=n(404608),i=function(e){return e===r.PreviewVariantActionStatusBar},a=function(e){return e===r.PreviewVariantHidden},o={kind:"useCurrent"},s=function(e){return e.kind===r.PreviewVariantActionStatusBar},d=function(e){return e.kind===r.PreviewVariantHidden},u=function(e){return"useCurrent"===e.kind},c=function(e){return e?{kind:e}:o},l=function(e){return r.PreviewVariants.includes(e)?e:void 0}},404608:(e,t,n)=>{"use strict";n.d(t,{PreviewVariantActionStatusBar:()=>r,PreviewVariantHidden:()=>i,PreviewVariants:()=>a});var r="action_status_bar",i="hidden",a=[r,i]},95146:(e,t,n)=>{"use strict";n.d(t,{SUPPORTED_OBJECT_TYPES:()=>r,SIZE_32:()=>i,SIZE_40:()=>a,SIZE_96:()=>o,SIZE_128:()=>s,REACTIONS_COUNTS_RESPONSE_FIELD:()=>d,WK_SECTION_PREFIX_REACTIONS:()=>u});var r={wall:"wall",wall_reply:"wall_reply"},i={width:32,height:32},a={width:40,height:40},o={width:96,height:96},s={width:128,height:128},d="reactions_counts",u="reactions"},646346:(e,t,n)=>{"use strict";n.d(t,{animationItemHasData:()=>o,getAnimationAsync:()=>s});var r=n(819633),i=(0,n(419223).makeSharedState)("reactions-animations-storage",(function(){return{animationItemsData:new Map}}),{version:0}),a=function(){return i().animationItemsData},o=function(e){return a().has(e)},s=(0,r.getAnimationAsync)({animationDataGet:function(e){var t=e.animationId;return a().get(t)},animationDataSet:function(e){var t=e.animationId,n=e.loadedAnimationData;a().set(t,n)},animationModuleLoader:r.animationModuleLoaderAsync})},485207:(e,t,n)=>{"use strict";n.d(t,{isDebugEnabled:()=>r.isDebugEnabled,ENABLED_IN_POST_REPLY:()=>i});var r=n(464746),i=!1},808591:(e,t,n)=>{"use strict";n.d(t,{isCounterEnabledForBtn:()=>a,getCounterForTitle:()=>o,isCounterEnabled:()=>s,isCounterAvailable:()=>d});var r=n(517760),i=n(70162),a=function(e){return!!e.getAttribute("data-reaction-button-text-is-counter")};function o(e,t,n,o){if(!a(e))return{kind:"disabled"};if(!n)return{kind:"error"};var s=0!==(o?(0,r.calcCountersSum)(o):0);if(!(0,r.hasReactionsForCounts)(n))return{kind:"enabled",allowZeroAnimation:s,buttonText:""};var d=(0,r.calcCounters)(n,t),u=(0,r.calcCountersWeightedSum)(d);return{kind:"enabled",allowZeroAnimation:s,buttonText:(0,i.langNumeric)(u,"%s",!0)}}function s(e){return!!e&&"disabled"!==e.kind}function d(e){return"enabled"===e.kind}},892239:(e,t,n)=>{"use strict";n.d(t,{addDataUpdateListener:()=>o,emitDataUpdate:()=>s,addReactionChooseListener:()=>d,emitReactionChoose:()=>u});var r=n(480816),i=(0,n(419223).makeSharedState)("reactions-menu-events",(function(){return{emitter:new r.default}}),{version:0}),a=function(){return i().emitter},o=function(e,t){var n,r=a(),i=((n={})[e+":data_update"]=t,n);return r.addListeners(i),function(){r.removeListeners(i)}},s=function(e,t){a().emit(e+":data_update",t)},d=function(e,t){var n,r=a(),i=((n={})[e+":reaction_choose"]=t,n);return r.addListeners(i),function(){r.removeListeners(i)}},u=function(e){a().emit(e+":reaction_choose")}},301718:(e,t,n)=>{"use strict";n.d(t,{getPreviewVariantForLikeBtn:()=>f,reactionsElemPayload:()=>_,shouldReactionsPreviewBeVisible:()=>p,updateReactionsPreview:()=>w,updateReactionsButtonForCounts:()=>b});var r=n(520820),i=n(517760),a=n(631351),o=n(70162),s=n(385667),d=n(672544),u=n(740672),c=n(908706),l=n(52521),v=n(93682),g=function(e){var t=e.getAttribute("data-reaction-counts");if(null===t)return{};var n=t?(0,r.parseJSON)(t):void 0;return"object"==typeof n&&null!==n?n:void 0},f=function(e){var t=e.getAttribute("data-reaction-preview-variant");if(t)return(0,c.parsePreviewVariant)(t)},_=function(e){var t=e.getAttribute("data-reaction-target-object"),n=e.getAttribute("data-reaction-hash"),r=e.getAttribute("data-reaction-set-id");if(null!==r){var a=e.getAttribute(v.ATTR_USER_REACTION_ID),o=a?(0,i.parseReactionIdOrUnset)(a):void 0,s=e.getAttribute("data-reaction-style-variant"),d=s&&(0,u.isValidButtonStyleVariant)(s)?s:void 0,c=e.getAttribute("data-reaction-menu-title-variant"),l=c&&(0,u.isValidButtonTitleVariant)(c)?c:void 0,_=f(e);return{counts:g(e),csrfHash:n,objectRaw:t,reactionSetId:r,styleVariant:d,titleVariant:l,userReactionId:o,previewVariant:_}}},p=function(e){return(0,i.hasReactionsForCounts)(e)},m=function(e,t){var n=t.counts,r=t.countsPrevious,u=t.objectRaw,c=t.reactionId,v=t.reactionSetId,g=t.styleVariant,f=(0,s.getReactionSet)(v),_=(0,i.calcCounters)(n,f),p=(0,i.calcCountersWeightedSum)(_),m=(0,i.calcCountersSum)(n),w=r?(0,i.calcCountersSum)(r):0,b=(0,d.getPreviewElem)(u);b&&((0,l.renderPreviewItems)(b,n,v,c,g),function(e,t,n,r){var i,s,d=(0,o.langNumeric)(n,(0,o.getLang)("reactions_n_reacted","raw")||"%s",!0);e.setAttribute("aria-label",d);var u=function(e){var t;return null!==(t=e.querySelector('[data-section-ref="like-button-count"]'))&&void 0!==t?t:void 0}(e);if(u){e.tt&&"object"==typeof e.tt&&(e.tt.shown||e.tt.showing||null===(s=null===(i=e.tt)||void 0===i?void 0:i.destroy)||void 0===s||s.call(i));var c=(0,o.langNumeric)(t,"%s",!0);(0,a.animateCount)(u,c,{allowZero:0!==r,str:!0,noWrapWidth:!0,noSpaceIfEmpty:!0})}}(b,p,m,w))},w=function(e,t){var n=(0,d.getLikeBtnElem)(e),r=t.counts;n&&r?function(e,t,n){var r=_(e);r&&r.objectRaw&&m(0,{counts:t,countsPrevious:n,objectRaw:r.objectRaw,reactionId:r.userReactionId,reactionSetId:r.reactionSetId,styleVariant:r.styleVariant})}(n,r,t.countsPrevious):console.warn("Unable to update object reactions",{objectRaw:e,options:t})},b=function(e,t){var n=t.counts,r=(0,d.getLikeBtnElem)(e);r&&function(e,t){e.setAttribute("data-reaction-counts",JSON.stringify(t))}(r,n)}},582982:(e,t,n)=>{"use strict";n.d(t,{reactionLogError:()=>a});var r=n(82701),i=n(385667),a=function(e){var t,n=e.error,a=(0,i.getReactionConfig)(),o=null!==(t=null==a?void 0:a.reportJsErrors)&&void 0!==t&&t;(0,r.reactionLogError)({error:n,reportError:o})}},672544:(e,t,n)=>{"use strict";n.d(t,{getLikeBtnElem:()=>r,getClosestLikeBtnContainerElem:()=>i,getLikeWrap:()=>a,getMenuMount:()=>o,getPreviewElem:()=>s});var r=function(e){var t;return null!==(t=document.querySelector('[data-section-ref="reactions-button"][data-reaction-target-object="'+e+'"]'))&&void 0!==t?t:void 0},i=function(e){var t;return null!==(t=e.closest('[data-section-ref="reactions-button-container"]'))&&void 0!==t?t:void 0},a=function(e){var t,n=r(e);if(n)return null!==(t=n.closest(".like_wrap"))&&void 0!==t?t:void 0},o=function(e){var t,n;return null!==(n=null===(t=e.closest('[data-section-ref="reactions-button-container"]'))||void 0===t?void 0:t.querySelector('[data-section-ref="reactions-menu-mount"]'))&&void 0!==n?n:null},s=function(e){return document.querySelector('[data-section-ref="reactions-preview-items"][data-reaction-target-object="'+e+'"]')}},385667:(e,t,n)=>{"use strict";n.d(t,{storageAddSets:()=>v,getReactionSet:()=>g,storageSetConfig:()=>f,getReactionConfig:()=>_});var r=n(570655),i=n(659397),a=n(517760),o=n(419223),s=n(582982),d=n(95146),u=n(485207),c=(0,o.makeSharedState)("reactions-storage",(function(){return new Map}),{version:0}),l=(0,o.makeSharedState)("reactions-config",(function(){return{config:void 0}}),{version:0}),v=function(e){(0,u.isDebugEnabled)()&&console.log(e),Object.entries(e).forEach((function(e){var t=(0,r.__read)(e,2),n=t[0],o=t[1],u=(0,a.validateReactionSetPayloaditems)(o,n);if(u)(0,s.reactionLogError)({error:u.error});else{var l=o.map((function(e){return(0,r.__assign)((0,r.__assign)({},e),{title:(0,i.decodeHTMLEntities)(e.title)})}));c().set(n,(0,a.prepareReactionMenuSet)(n,l,{imageMenuSize:d.SIZE_96,imagePreviewSize:d.SIZE_32,imageStoryPanelSize:d.SIZE_128,imageStoryPreviewSize:d.SIZE_40}))}}))},g=function(e){var t=c().get(e);if(t)return t;var n=new Error("Reaction set not found: "+e);(0,s.reactionLogError)({error:n})},f=function(e){(0,u.isDebugEnabled)()&&console.log(e);var t=(0,a.parseReactionMenuConfig)(e);t?l().config=t:console.warn("Reactions: invalid menu config passed",e)},_=function(){var e;return null===(e=l())||void 0===e?void 0:e.config}},740672:(e,t,n)=>{"use strict";n.d(t,{isValidEnvironment:()=>o,preloadImage:()=>s,usePrevious:()=>d,usePreviousRef:()=>u,isValidButtonTitleVariant:()=>l,isValidButtonStyleVariant:()=>v});var r=n(667294),i=n(1925),a=n(54789),o=function(){var e,t,n;return"function"==typeof(null===(e=window.cur)||void 0===e?void 0:e.viewAsBox)?(window.cur.viewAsBox(),!1):!(window.vk.widget&&!window.vk.id)||(null===(n=null===(t=window.Widgets)||void 0===t?void 0:t.oauth)||void 0===n||n.call(t),!1)},s=function(e){return new Promise((function(t,n){var r=new Image;r.src=e,r.onload=function(){return t()},r.onerror=function(){return n()}}))},d=function(e){var t=(0,r.useRef)(e);return(0,r.useEffect)((function(){t.current=e})),t.current},u=function(e){var t=(0,r.useRef)(e);return(0,r.useEffect)((function(){t.current=e})),t},c=Object.values(a.ButtonStyleVariant),l=function(e){return i.ReactionMenuTitleVariants.includes(e)},v=function(e){return c.includes(e)}},665872:(e,t,n)=>{"use strict";n.d(t,{reactionsCountsUpdatePayload:()=>a,isReactionsFullUpdatePayload:()=>o,reactionsCountsOnlyUpdatePayload:()=>s});var r=n(570655),i=n(571904),a=function(e,t){return(0,r.__assign)((0,r.__assign)({kind:i.PayloadKindFull},e),{reactionIdState:{reactionId:t.id}})},o=function(e){return e.kind===i.PayloadKindFull},s=function(e){return(0,r.__assign)({kind:i.PayloadKindCountsOnly},e)}},571904:(e,t,n)=>{"use strict";n.d(t,{PayloadKindCountsOnly:()=>r,PayloadKindFull:()=>i});var r="counts_only",i="counts_with_current_reaction"},130273:(e,t,n)=>{"use strict";n.d(t,{postRenderReactionsInit:()=>C});var r=n(570655),i=n(330752),a=n(659397),o=n(613327),s=n(873589),d=n(964141),u=n(465864),c=n(485207),l=n(301718),v=n(908706),g=n(672544),f=n(665872),_=n(267740),p=n(44610),m=n(928634),w=n(892239),b=n(404608),h=n(385667),I=function(e,t,n){var r;void 0===n&&(n=null===(r=window.cur)||void 0===r?void 0:r.wallTpl);var i=null==n?void 0:n[e];if(i)return(0,d.stripPercentVars)((0,s.rs)(i,t));console.warn("renderTemplate: missing template '"+e+"'",n)},y=function(e){for(var t=e.isUserAction,n=void 0!==t&&t,i=[],a=1;a<arguments.length;a++)i[a-1]=arguments[a];n?console.error.apply(console,(0,r.__spreadArray)([],(0,r.__read)(i),!1)):(0,c.isDebugEnabled)()&&console.warn.apply(console,(0,r.__spreadArray)([],(0,r.__read)(i),!1))};var B=function(e,t,n){var r=n.isActionStatusBarVisible,i=n.isReactionsPreviewVisible,o=n.positionTrackingEnd,d=function(e,t){var n,r,i=(0,g.getLikeWrap)(e);if(i){var a=(0,p.getPostElem)(t,i),o=null==a?void 0:a.querySelector('[data-section-ref="post-action-status-bar"]');if(o)return{actionStatusBar:o};var d=(0,m.isWkLayerWallPostOpen)()?null===(n=window.wkcur)||void 0===n?void 0:n.wallTpl:null===(r=window.cur)||void 0===r?void 0:r.wallTpl,u=(0,s.se)(I("post_action_status_bar",{class:"PostActionStatusBar--hidden"},d));if(u)return(0,s.domInsertBefore)(u,i),{actionStatusBar:u}}}(e,t.postFullId);if(d){var u=d.actionStatusBar;if(u.classList.toggle("PostActionStatusBar--hidden",!r),r&&!(0,g.getPreviewElem)(e)){var c=function(e,t,n){var r,i;void 0===n&&(n={});var o=(0,m.isWkLayerWallPostOpen)()?null===(r=window.wkcur)||void 0===r?void 0:r.wallTpl:null===(i=window.cur)||void 0===i?void 0:i.wallTpl,s=(0,a.classNames)({"ReactionsPreview--empty":!e,"ReactionsPreview--isInActionStatusBar":!!n.isInActionStatusBar});return I("post_reactions_preview",{class:s,object_raw:t},o)}(i,e,{isInActionStatusBar:!0});u.prepend((0,s.se)(c))}if(o){var l=(0,g.getLikeBtnElem)(e);null==o||o(l)}}else y({},"Unable to init ActionStatusBar in post",t)},S=function(e){if(function(e){return void 0!==e.counts}(e)){var t=(0,u.likePostObjectId)(e.postFullId),n=(0,p.getPostElem)(e.postFullId,(0,g.getLikeWrap)(t));n||y(e,"Missing post element for reactions preview update",{payload:e,likeWrap:(0,g.getLikeWrap)(t)});var r=(0,g.getLikeBtnElem)(t);if(r){var i=(0,l.reactionsElemPayload)(r),a=null==i?void 0:i.counts;E({elemPayload:i,likeBtnElem:r,likeObjectId:t,payload:e}),R({countsPrevious:a,likeBtnElem:r,likeObjectId:t,payload:e,postEl:n})}else y(e,"Unable to find reactions button",{likeObjectId:t})}else y(e,"Counts is invalid or missing")},E=function(e){var t=e.elemPayload,n=e.likeBtnElem,r=e.likeObjectId,a=e.payload,o=a.counts;if(!!a.isQueueUpdate&&function(e){var t=(0,i.getLastOwnReactionChangeTime)(e);if(!t)return!1;var n=t+1e4;return Date.now()<n}(n))(0,c.isDebugEnabled)()&&console.log("Ignoring reactions update from queue",a);else{if(t){var s=t.counts,d=t.reactionSetId,u=(0,h.getReactionSet)(d);if((0,f.isReactionsFullUpdatePayload)(a)){var v=a.reactionIdState.reactionId;u&&(0,i.updateReactionButtonForCurrentReaction)(n,v,u,a.isUserAction)}u&&((0,i.updateReactionButtonCounts)(n,u,a.isUserAction,o,s),(0,i.updateReactionButtonContainerForCounts)(n,o))}if((0,f.isReactionsFullUpdatePayload)(a)){v=a.reactionIdState.reactionId;(0,i.setDataCurrentId)(n,v),a.isUserAction&&(null==t?void 0:t.objectRaw)&&(0,w.emitDataUpdate)(t.objectRaw,{currentReactionId:v})}(0,l.updateReactionsButtonForCounts)(r,{counts:o})}},R=function(e){var t=e.countsPrevious,n=e.likeBtnElem,r=e.likeObjectId,i=e.payload,a=e.postEl,s=i.counts,d=i.previewVisibility,u=function(e,t){if((0,v.isIntentPreviewInActionStatusBar)(e))return{previewVariant:b.PreviewVariantActionStatusBar};if((0,v.isIntentPreviewHidden)(e))return{previewVariant:b.PreviewVariantHidden};if((0,v.isIntentPreviewUseCurrent)(e)){var n=(0,l.getPreviewVariantForLikeBtn)(t);if(n)return{previewVariant:n}}}(void 0===d?v.previewVisibilityUseCurrent:d,n);if(u){var c=u.previewVariant,g=(0,v.isVariantInActionStatusBar)(c),f=(0,l.shouldReactionsPreviewBeVisible)(s),_=(0,v.isVariantHidden)(c)||g&&!f;if(g){var p=void 0;i.isPrimaryLikeButtonClick&&!i.isFromWkLayer&&(p=(0,o.preservePositionBetween)(n).start());var m=f;null==a||a.classList.toggle("post--withActionStatusBar",m),B(r,i,{isActionStatusBarVisible:m,isReactionsPreviewVisible:f,positionTrackingEnd:p})}_||(0,l.updateReactionsPreview)(r,{counts:s,countsPrevious:t})}},L=function(e){if(!c.ENABLED_IN_POST_REPLY)return!1;var t=e.counts;if(t){var n=(0,u.likeReplyObjectId)(e.replyFullId);(0,l.updateReactionsPreview)(n,{counts:t,countsPrevious:void 0}),(0,l.updateReactionsButtonForCounts)(n,{counts:t})}},C=function(){var e=[(0,_.registerUniqueListener)("wall-post-action-status-bar",_.WallDataEvents.post_reactions_counts_update,S),(0,_.registerUniqueListener)("wall-reply-reactions-counts",_.WallDataEvents.reply_reactions_counts_update,L)];return{onDestroy:function(){e.forEach((function(e){e()})),e=[]}}}},453580:(e,t,n)=>{"use strict";n.d(t,{WallDataEvents:()=>o,registerUniqueListener:()=>u,registerNonGlobalNonUniqueListener:()=>c,emitEvent:()=>l});var r=n(570655),i=n(480816),a=n(419223),o={post_reactions_counts_update:"wall/post_reactions_counts_update",reply_reactions_counts_update:"wall/reply_reactions_counts_update",post_subscribe_update:"wall/post_subscribe_update"},s=(0,a.makeSharedState)("wall-data",(function(){return{emitter:new i.default,keyedListeners:Object.create(null)}}),{version:0}),d=function(e,t,n){var i,a,o=s(),d=null===(a=null===(i=o.keyedListeners)||void 0===i?void 0:i[e])||void 0===a?void 0:a[t];return d&&o.emitter.removeListener(e,d),function(e,t,n){var i,a=s();return a.emitter.addListener(e,n),a.keyedListeners[e]=(0,r.__assign)((0,r.__assign)({},a.keyedListeners[e]),((i={})[t]=n,i)),function(){var r,i;a.emitter.removeListener(e,n),(null===(r=a.keyedListeners[e])||void 0===r?void 0:r[t])===n&&(null===(i=a.keyedListeners[e])||void 0===i||delete i[t])}}(e,t,n)},u=function(e,t,n){return d(t,e,n)},c=function(e,t){return function(e,t){var n=s();return n.emitter.addListener(e,t),function(){n.emitter.removeListener(e,t)}}(e,t)},l=function(e,t){s().emitter.emit(e,t)}},267740:(e,t,n)=>{"use strict";n.d(t,{WallDataEvents:()=>r.WallDataEvents,registerUniqueListener:()=>r.registerUniqueListener});var r=n(453580)},44610:(e,t,n)=>{"use strict";n.d(t,{getPostElem:()=>r,replyUserImageLinkClosest:()=>i,replyUserImageImg:()=>a});var r=function(e,t){var n,r;return null!==(r=null!==(n=function(e){var t;if("string"==typeof e)return null!==(t=document.querySelector("#post"+e))&&void 0!==t?t:void 0}(e))&&void 0!==n?n:null==t?void 0:t.closest("._post, .wl_post"))&&void 0!==r?r:void 0},i=function(e){var t;return null!==(t=e.closest(".reply_image, ._reply_image"))&&void 0!==t?t:void 0},a=function(e){var t;return null!==(t=e.querySelector("img.reply_img"))&&void 0!==t?t:void 0}},928634:(e,t,n)=>{"use strict";n.d(t,{isWkLayerWallPostOpen:()=>i,preparePostElToDetaching:()=>a,updatePostElAfterAttaching:()=>o});var r=n(660080),i=function(){return!!window.cur.wallLayer},a=function(e){var t,n=e.querySelector("."+r.UI_GALLERY_CLASSNAME);if(n){var i=null===(t=n.querySelector("."+r.UI_GALLERY_CONTENT_CLASSNAME))||void 0===t?void 0:t.scrollLeft;i&&(n.dataset.contentScrollLeft=i.toString())}},o=function(e){var t=e.querySelector("."+r.UI_GALLERY_CLASSNAME);if(t){var n=t.querySelector("."+r.UI_GALLERY_CONTENT_CLASSNAME),i=t.dataset.contentScrollLeft;n&&i&&(n.scrollLeft=parseInt(i,10))}}}}]);try{stManager.done("dist/90f8cf219bb6d5a2f2ecd964325e4940.a473f98c2f0d16444dac.js")}catch(e){}